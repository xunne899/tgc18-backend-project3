{{#extends 'base'}}

{{#block 'content'}}
{{!-- <h3 class="mt-4">Products</h3> --}}
     <h2 class="mt-4"> {{product.name}}  </h2>
                <img src="{{product.image_url}}" style=" width:300px" class="img-fluid"/>
                
{{!-- <table class="table">
    <thead>
        <tr> --}}
            {{!-- <th>Image</th>
            <th>ID</th>
            <th>Created Date</th>
             <th>Type</th>
            <th>Name</th>
            <th>Country</th> --}}
           <div class="mt-4"> 
            <h5 class="mt-2">Description</h5>
            <div >
            {{product.description}}
            </div>
            </div>
            {{!-- <th>Ingredients</th>
            <th>Packaging</th>
            <th>Shelf Life(Yrs)</th>
            <th>Cuisine Style</th>
             <th>Vegan</th>
             <th>Halal</th> --}}
            {{!-- <th></th>
            <th></th>
            
        </tr>

    </thead> --}}
    <tbody>
            <tr >
              
                {{!-- <td >
                    {{product.id}}
                </td>
                  <td >
                    {{moment product.created_date format="YYYY-MM-DD"}}
                </td>
                 <td >
                    {{product.type.type}}
                </td>
                <td >
                    {{product.name}}
                </td>
                <td >
                    {{product.country.country}}
                </td> --}}
                <td>
                    
                </td>
               
                  {{!-- <td >
                    {{#each product.ingredients}}
                     <span>{{this.ingredient}}</span>
                      {{/each}}
                </td>
                  {{!-- <td >
                    {{this.sizes.size}}
                </td> --}}
                 {{!-- <td>
                    {{product.packaging.packaging}}
                </td>
                 <td>
                    {{product.shelf_life}}
                </td> --}}
               {{!-- <td >
                    
                     {{this.spiciness.spiciness}}</span>
                   
                </td> --}}
                  {{!-- <td >
              {{#each product.cuisine_styles}}
                     <span>{{this.cuisine_style}}</span>
                      {{/each}}
                    
                </td>
                 <td>
                    {{product.vegan}}
                </td>
                  <td >
                    {{product.halal}}
                </td>
                <td></td>
                <td></td>  --}}
                 {{!-- </tr>
                 </tbody> --}}
</table>

   <div class="d-flex justify-content-between mt-5">
    <h3 >Variants</h3>
    <a href="/products/{{product.id}}/variant/create" class="btn btn-dark btn-sm d-flex align-items-center">Add Variant</a>
</div>
{{!-- <h3 class="mt-5">Variants</h3> --}}

    <table class="table">
    <thead>
        <tr>
             {{!-- <th></th> --}}
            <th>ID</th>
            <th>Stock</th>
             <th>Cost</th>
            <th>Spiciness</th>
            <th>Size</th>
               <th></th>
            <th></th>
            
        </tr>

    </thead>
   
    <tbody>
        {{#each variants}}
            <tr >
                  {{!-- <td >
                  <img src="{{this.image_url}}" width="100"  class="img-fluid"/>
                </td> --}}
                <td >
                    {{this.id}}
                </td>
                  <td >
                    {{this.stock}}
                </td>
                 <td >
                    {{this.cost}}
                </td>
                <td >
                    {{this.spiciness.spiciness}}
                </td>
                <td>
                    {{this.size.size}}
                </td>
           
                <td>
                       <br>
                    {{!-- <a href="/products/{{product.id}}/variant/create" class="ms-1" ><i class="fa fa-plus " style="font-size:23px;color:black"></i></a> --}}
                       <a href="/products/{{product.id}}/variant/{{this.id}}/update"><i class="fa fa-edit" style="font-size:23px;color:black"></i></a>
                       <a href="/products/{{product.id}}/variant/{{this.id}}/delete"><i class="fa fa-trash " style="font-size:23px;color:black"></i></a>
                       <br>
                       <a href="/cart/{{this.id}}/add" class="btn btn-success btn-sm mt-2">Add to cart</a>
                  </td>
                   <td></td>
               
                  {{/each}}
                   
               
                    {{!-- <a  href="/products/create-variants" class="btn btn-primary">Add Variant</a> --}}
                   </tbody>
                    </tr>
</table>
{{/block}}

{{/extends}}
{{#block js}}

<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"
    integrity="sha512-bZS47S7sPOxkjU/4Bt0zrhEtWx0y0CRkhEp8IckzK+ltifIIE9EMIMTuT/mEzoIMewUINruDBIR/jJnbguonqQ=="
    crossorigin="anonymous"></script>
<script src="https://widget.cloudinary.com/v2.0/global/all.js" type="text/javascript"></script>
<script>
    function generateSignature(callback, params_to_sign) {
        axios.get('/cloudinary/sign', {
            params: {
                params_to_sign
            }
        }).then(function (response) {
            callback(response.data);
        })
    }

    var myWidget = cloudinary.createUploadWidget({
        cloudName: '{{cloudinaryName}}',
        apiKey: '{{cloudinaryApiKey}}',
        uploadPreset: '{{cloudinaryPreset}}',
        uploadSignature: generateSignature
    }, (error, result) => {
        if (!error && result && result.event === "success") {
            console.log('Done! Here is the image info: ', result.info);
            // hide the upload widget 
            //document.querySelector('#upload_widget').style.display = "block";

            // display the image
            document.querySelector('#id_image_url').value = result.info.url;
            document.querySelector('#uploaded_image').src = result.info.url;
            document.querySelector('#uploaded_image').style.display = 'block';
        }
    }
    )

    document.getElementById("upload_widget").addEventListener("click", function () {
        myWidget.open();
    }, false);
</script>

{{/block}}
